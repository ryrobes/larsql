{
  "cascade_id": "contact_extractor_flow",
  "description": "Extract contact information with schema validation",
  "inputs_schema": {
    "text": "Text containing contact information"
  },
  "cells": [
    {
      "name": "extract_contact",
      "instructions": "Extract contact information from the following text:\n\n{{ input.text }}\n\nReturn ONLY a JSON object with this structure:\n{\n  \"name\": \"Full name\",\n  \"email\": \"email@example.com\",\n  \"phone\": \"phone number\"\n}\n\nDo not include any other text or markdown formatting.",
      "output_schema": {
        "type": "object",
        "required": [
          "name",
          "email",
          "phone"
        ],
        "properties": {
          "name": {
            "type": "string",
            "minLength": 1
          },
          "email": {
            "type": "string",
            "pattern": "^[^@]+@[^@]+\\.[^@]+$"
          },
          "phone": {
            "type": "string",
            "minLength": 7
          }
        }
      },
      "rules": {
        "max_turns": 1,
        "max_attempts": 3,
        "retry_instructions": "\ud83d\udccb Schema Error:\n\n{{ schema_error }}\n\nPlease return a valid JSON object with name, email, and phone fields. Ensure email has @ symbol and phone is at least 7 characters.\n\nAttempt {{ attempt }}/{{ max_attempts }}"
      },
      "handoffs": [
        "confirm"
      ]
    },
    {
      "name": "confirm",
      "instructions": "Contact information extracted successfully!\n\nValidated data:\n- Name: {{ state.validated_output.name }}\n- Email: {{ state.validated_output.email }}\n- Phone: {{ state.validated_output.phone }}\n\nProvide a brief confirmation message.",
      "traits": [
        "set_state"
      ]
    }
  ]
}