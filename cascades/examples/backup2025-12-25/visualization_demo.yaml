cascade_id: visualization_demo
description: Demo of multi-modal outputs - matplotlib, plotly, and PIL images
inputs_schema:
  num_points: 'Number of data points to generate (default: 100)'
cells:
- name: generate_data
  tool: python_data
  inputs:
    code: "import numpy as np\n\nn = int(input.get('num_points', 100))\n\n# Generate\
      \ sample data\nnp.random.seed(42)\ncategories = ['Electronics', 'Clothing',\
      \ 'Food', 'Books', 'Home']\n\ndf = pd.DataFrame({\n    'date': pd.date_range('2024-01-01',\
      \ periods=n, freq='D'),\n    'category': np.random.choice(categories, n),\n\
      \    'sales': np.random.exponential(1000, n),\n    'quantity': np.random.poisson(10,\
      \ n),\n    'rating': np.random.uniform(1, 5, n)\n})\n\nresult = df\n"
- name: matplotlib_chart
  tool: python_data
  context:
    from:
    - generate_data
  inputs:
    code: 'import matplotlib

      matplotlib.use(''Agg'')  # Non-interactive backend

      import matplotlib.pyplot as plt


      # Get data from previous cell

      df = data.generate_data


      # Create matplotlib figure

      fig, axes = plt.subplots(2, 2, figsize=(12, 10))

      fig.suptitle(''Sales Analysis Dashboard'', fontsize=16, color=''white'')


      # Style for dark theme

      plt.style.use(''dark_background'')


      # Plot 1: Time series

      daily = df.groupby(''date'')[''sales''].sum().reset_index()

      axes[0, 0].plot(daily[''date''], daily[''sales''], color=''#2dd4bf'', linewidth=2)

      axes[0, 0].fill_between(daily[''date''], daily[''sales''], alpha=0.3, color=''#2dd4bf'')

      axes[0, 0].set_title(''Daily Sales'', color=''white'')

      axes[0, 0].set_xlabel(''Date'', color=''#94a3b8'')

      axes[0, 0].set_ylabel(''Sales ($)'', color=''#94a3b8'')

      axes[0, 0].tick_params(colors=''#64748b'')


      # Plot 2: Category breakdown

      cat_sales = df.groupby(''category'')[''sales''].sum().sort_values(ascending=True)

      colors = [''#a78bfa'', ''#60a5fa'', ''#2dd4bf'', ''#fbbf24'', ''#f87171'']

      axes[0, 1].barh(cat_sales.index, cat_sales.values, color=colors)

      axes[0, 1].set_title(''Sales by Category'', color=''white'')

      axes[0, 1].set_xlabel(''Total Sales ($)'', color=''#94a3b8'')

      axes[0, 1].tick_params(colors=''#64748b'')


      # Plot 3: Distribution

      axes[1, 0].hist(df[''sales''], bins=30, color=''#60a5fa'', alpha=0.7, edgecolor=''#1a2028'')

      axes[1, 0].set_title(''Sales Distribution'', color=''white'')

      axes[1, 0].set_xlabel(''Sales ($)'', color=''#94a3b8'')

      axes[1, 0].set_ylabel(''Frequency'', color=''#94a3b8'')

      axes[1, 0].tick_params(colors=''#64748b'')


      # Plot 4: Scatter

      axes[1, 1].scatter(df[''quantity''], df[''sales''], c=df[''rating''], cmap=''viridis'',
      alpha=0.6)

      axes[1, 1].set_title(''Quantity vs Sales (colored by rating)'', color=''white'')

      axes[1, 1].set_xlabel(''Quantity'', color=''#94a3b8'')

      axes[1, 1].set_ylabel(''Sales ($)'', color=''#94a3b8'')

      axes[1, 1].tick_params(colors=''#64748b'')


      plt.tight_layout()

      result = fig

      '
- name: plotly_chart
  tool: python_data
  context:
    from:
    - generate_data
  inputs:
    code: "import plotly.express as px\n\ndf = data.generate_data\n\n# Create interactive\
      \ Plotly chart\nfig = px.scatter(\n    df,\n    x='quantity',\n    y='sales',\n\
      \    color='category',\n    size='rating',\n    hover_data=['date', 'rating'],\n\
      \    title='Interactive Sales Analysis',\n    labels={'quantity': 'Quantity\
      \ Sold', 'sales': 'Sales ($)'}\n)\n\nfig.update_layout(\n    template='plotly_dark',\n\
      \    title_font_size=20,\n    legend_title_text='Category'\n)\n\nresult = fig\n"
- name: plotly_bar
  tool: python_data
  context:
    from:
    - generate_data
  inputs:
    code: "import plotly.express as px\n\ndf = data.generate_data\n\n# Aggregate by\
      \ category\ncat_stats = df.groupby('category').agg({\n    'sales': 'sum',\n\
      \    'quantity': 'sum',\n    'rating': 'mean'\n}).reset_index()\n\nfig = px.bar(\n\
      \    cat_stats,\n    x='category',\n    y='sales',\n    color='rating',\n  \
      \  color_continuous_scale='Viridis',\n    title='Total Sales by Category',\n\
      \    labels={'sales': 'Total Sales ($)', 'rating': 'Avg Rating'}\n)\n\nfig.update_layout(template='plotly_dark')\n\
      \nresult = fig\n"
- name: gradient_image
  tool: python_data
  inputs:
    code: "# Create a gradient image using numpy and PIL\nfrom PIL import Image\n\n\
      # Create gradient\nwidth, height = 400, 200\ngradient = np.zeros((height, width,\
      \ 3), dtype=np.uint8)\n\n# Create a teal-to-purple gradient\nfor x in range(width):\n\
      \    r = int(45 + (167 - 45) * x / width)   # 45 -> 167 (teal to purple red)\n\
      \    g = int(212 + (139 - 212) * x / width) # 212 -> 139 (teal to purple green)\n\
      \    b = int(191 + (250 - 191) * x / width) # 191 -> 250 (teal to purple blue)\n\
      \    gradient[:, x] = [r, g, b]\n\n# Add some noise for texture\nnoise = np.random.randint(0,\
      \ 20, (height, width, 3), dtype=np.uint8)\ngradient = np.clip(gradient.astype(np.int16)\
      \ + noise.astype(np.int16) - 10, 0, 255).astype(np.uint8)\n\n# Convert to PIL\
      \ Image\nimg = Image.fromarray(gradient, mode='RGB')\n\nresult = img\n"
- name: summary
  tool: python_data
  context:
    from:
    - generate_data
  inputs:
    code: "df = data.generate_data\n\n# Convert date column to datetime if it's strings\n\
      df['date'] = pd.to_datetime(df['date'])\n\nresult = {\n    \"total_records\"\
      : len(df),\n    \"total_sales\": round(df['sales'].sum(), 2),\n    \"avg_rating\"\
      : round(df['rating'].mean(), 2),\n    \"top_category\": df.groupby('category')['sales'].sum().idxmax(),\n\
      \    \"date_range\": f\"{df['date'].min().strftime('%Y-%m-%d')} to {df['date'].max().strftime('%Y-%m-%d')}\"\
      \n}\n"
