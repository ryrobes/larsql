cascade_id: code_reviewer
description: 'A multi-phase code review cascade that demonstrates the benefits of
  YAML for markdown-heavy prompt definitions.

  '
inputs_schema:
  code: The code to review
  language: The programming language (optional)
cells:
- name: security_review
  instructions: "# Security Review\n\nYou are a security expert reviewing code for\
    \ vulnerabilities.\n\n## Code to Review\n\n```{{ input.language | default('')\
    \ }}\n{{ input.code }}\n```\n\n## Your Task\n\nAnalyze this code for security\
    \ issues. Look for:\n\n1. **Injection vulnerabilities**\n   - SQL injection\n\
    \   - Command injection\n   - XSS\n\n2. **Authentication/Authorization issues**\n\
    \   - Missing auth checks\n   - Weak credential handling\n\n3. **Data exposure**\n\
    \   - Sensitive data in logs\n   - Unencrypted data transmission\n\n## Output\
    \ Format\n\nFor each issue found, provide:\n- **Severity**: Critical / High /\
    \ Medium / Low\n- **Location**: Line number or code snippet\n- **Description**:\
    \ What the vulnerability is\n- **Fix**: How to remediate it\n\nIf no issues are\
    \ found, state that the code passes security review.\n"
  skills: []
  handoffs:
  - quality_review
- name: quality_review
  instructions: '# Code Quality Review


    You are a senior developer reviewing code quality.


    ## Code to Review


    ```{{ input.language | default('''') }}

    {{ input.code }}

    ```


    ## Previous Security Review


    {{ outputs.security_review }}


    ## Your Task


    Review this code for quality issues:


    ### Readability

    - Clear variable/function names

    - Appropriate comments

    - Consistent formatting


    ### Maintainability

    - DRY principles

    - Single responsibility

    - Proper error handling


    ### Performance

    - Obvious inefficiencies

    - N+1 queries

    - Unnecessary allocations


    ## Output Format


    Provide a structured review with:


    1. **Overall Score**: A/B/C/D/F

    2. **Strengths**: What the code does well

    3. **Areas for Improvement**: Specific suggestions

    4. **Refactoring Recommendations**: If any major changes are needed

    '
  skills: []
  context:
    from:
    - security_review
