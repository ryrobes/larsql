cascade_id: semantic_classify_collection
internal: true
description: 'Collection classification - classifies an entire collection of texts

  into one of the provided categories based on overall content.

  '
inputs_schema:
  texts: JSON array of texts to classify
  categories: Comma-separated list of category names
  prompt: Optional custom classification criteria
sql_function:
  name: semantic_classify_collection
  description: Classifies a text collection into one category
  args:
  - name: texts
    type: JSON
  - name: categories
    type: VARCHAR
  - name: prompt
    type: VARCHAR
    optional: true
  returns: VARCHAR
  shape: AGGREGATE
  context_arg: texts
  operators:
  - CLASSIFY({{ texts }}, '{{ categories }}')
  - CLASSIFY({{ texts }}, '{{ categories }}', '{{ prompt }}')
  cache: true
  test_cases:
  - sql: |
      WITH test_data AS (
        SELECT * FROM (VALUES
          ('The cat sat on the mat'),
          ('Dogs love to play fetch'),
          ('My parrot talks all day'),
          ('Fish swim in the tank')
        ) AS t(text)
      )
      SELECT CLASSIFY(text, 'animal stories, food recipes, sports news') FROM test_data
    expect:
      type: contains
      value: animal
    description: Classifies pet-related texts correctly
cells:
- name: classify_collection
  model: google/gemini-2.5-flash-lite
  instructions: 'Classify this collection of texts into ONE of the provided categories.


    TEXTS:

    {{ input.texts }}


    CATEGORIES: {{ input.categories }}


    {% if input.prompt %}

    CLASSIFICATION CRITERIA: {{ input.prompt }}

    {% else %}

    Consider the overall theme, tone, and content of all texts together.

    {% endif %}


    Which category best describes this collection as a whole?


    Return ONLY the category name (exactly as provided), nothing else.

    '
  rules:
    max_turns: 1
