cascade_id: semantic_contradicts
internal: true
description: 'Logical contradiction check - returns TRUE if text A contradicts text
  B.

  Used for finding inconsistent reports or filtering out conflicting information.

  '
inputs_schema:
  text_a: The first text
  text_b: The second text or criterion
sql_function:
  name: semantic_contradicts
  description: Returns TRUE if text_a contradicts text_b
  args:
  - name: text_a
    type: VARCHAR
  - name: text_b
    type: VARCHAR
  returns: BOOLEAN
  shape: SCALAR
  operators:
  - '{{ text_a }} CONTRADICTS {{ text_b }}'
  cache: true
  test_cases:
  # Function syntax
  - sql: SELECT semantic_contradicts('The product is excellent', 'The product is terrible')
    expect: true
    description: "Function: Contradicting statements detected"
  - sql: SELECT semantic_contradicts('The sky is blue', 'Water is wet')
    expect: false
    description: "Function: Non-contradicting statements"
  # Infix CONTRADICTS syntax - need WITH for proper parsing
  - sql: "WITH t AS (SELECT 'We will increase prices' AS stmt) SELECT stmt FROM t WHERE stmt CONTRADICTS 'Prices will remain stable'"
    expect:
      type: contains
      value: increase prices
    description: "Infix CONTRADICTS: detects price contradiction"
  # Skip flaky test - LLM interpretation of "3pm" vs "afternoon" varies
  - sql: "WITH t AS (SELECT 'The meeting is at 3pm' AS stmt) SELECT CASE WHEN stmt CONTRADICTS 'The meeting is in the afternoon' THEN 'yes' ELSE 'no' END FROM t"
    skip: true
    expect: "no"
    description: "Infix CONTRADICTS: compatible statements (skipped - LLM varies)"
cells:
- name: check_contradiction
  model: google/gemini-2.5-flash-lite
  instructions: 'Do these two texts contradict each other?


    TEXT A: {{ input.text_a }}


    TEXT B: {{ input.text_b }}


    A contradiction means: Both texts cannot be true at the same time.


    Consider:

    - Do they make opposing claims about the same thing?

    - Are they logically incompatible?

    - Does one negate or deny what the other asserts?


    Respond with ONLY "true" or "false" - no explanation.

    '
  rules:
    max_turns: 1
  output_schema:
    type: boolean
