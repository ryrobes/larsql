cascade_id: credibility_dimension
internal: true
description: 'Semantic credibility dimension function. Analyzes reliability/trustworthiness

  of witness descriptions or claims with configurable strictness.


  This is a DIMENSION-shaped function for use in GROUP BY clauses.

  '
inputs_schema:
  texts: JSON array of all text values to analyze
  strictness: Evaluation strictness ('lenient', 'balanced', 'strict')
  num_levels: Number of credibility levels (default 5)
sql_function:
  name: credibility
  description: 'Analyze credibility/reliability of text descriptions.

    First arg is the column, remaining args are modifiers.

    '
  shape: DIMENSION
  mode: mapping
  args:
  - name: text
    type: VARCHAR
    role: dimension_source
  - name: strictness
    type: VARCHAR
    default: balanced
  - name: num_levels
    type: INTEGER
    default: 5
  returns: VARCHAR
  cache: true
  test_cases:
  - sql: SELECT credibility('Peer-reviewed study shows...')
    expect:
      type: regex
      pattern: .+
    description: Credibility assessed
cells:
- name: analyze_credibility
  model: google/gemini-2.5-flash-lite
  instructions: "Analyze the credibility of these {{ input.texts | length }} descriptions.\n\
    \nEVALUATION STRICTNESS: {{ input.strictness | default('balanced') }}\n{% if input.strictness\
    \ == 'strict' %}\nApply STRICT criteria:\n- Require specific details (dates, times,\
    \ measurements)\n- Penalize vague language heavily\n- Require corroborating factors\n\
    {% elif input.strictness == 'lenient' %}\nApply LENIENT criteria:\n- Accept general\
    \ descriptions\n- Give benefit of doubt\n- Focus on internal consistency\n{% else\
    \ %}\nApply BALANCED criteria:\n- Look for reasonable detail\n- Consider internal\
    \ consistency\n- Weigh specificity appropriately\n{% endif %}\n\nUse {{ input.num_levels\
    \ | default(5) }} credibility levels, for example:\n- \"Very Low Credibility\"\
    \n- \"Low Credibility\"\n- \"Moderate Credibility\"\n- \"High Credibility\"\n\
    - \"Very High Credibility\"\n\nDescriptions to analyze (with index numbers):\n\
    {% for v in input.texts %}\n[{{ loop.index0 }}] \"{{ v | replace('\"', '\\\\\"\
    ') }}\"\n{% endfor %}\n\nReturn a JSON object mapping each text's INDEX NUMBER\
    \ to its credibility level:\n\n{\n  \"mapping\": {\n    \"0\": \"Credibility Level\"\
    ,\n    \"1\": \"Credibility Level\",\n    ...\n  }\n}\n\nIMPORTANT:\n- Use the\
    \ INDEX NUMBER (0, 1, 2, ...) as keys, NOT the original text\n- Credibility level\
    \ names should be consistent\n- Return ONLY the JSON object\n"
  rules:
    max_turns: 1
  output_schema:
    type: object
    properties:
      mapping:
        type: object
    required:
    - mapping
