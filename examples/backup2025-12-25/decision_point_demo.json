{
  "cascade_id": "decision_point_demo",
  "description": "Demonstrates LLM-generated decision points for dynamic HITL interactions",
  "inputs_schema": {
    "data": "Sample data to process (will trigger a decision point)"
  },
  "phases": [
    {
      "name": "process_with_decision",
      "instructions": "You are processing some data and you encounter an ambiguity that requires human input.\n\nThe input data is: {{ input.data }}\n\nPretend you found a field called 'uid' that doesn't match the expected schema.\n\nOutput a decision block asking the human how to handle it:\n\n<decision>\n{\n  \"question\": \"How should I map the 'uid' field?\",\n  \"context\": \"The target schema expects either 'user_id' (database convention) or 'userId' (API convention). The source data has 'uid'.\",\n  \"severity\": \"warning\",\n  \"options\": [\n    {\n      \"id\": \"user_id\",\n      \"label\": \"Rename to user_id\",\n      \"description\": \"Follows database naming convention (snake_case)\",\n      \"style\": \"primary\"\n    },\n    {\n      \"id\": \"userId\",\n      \"label\": \"Rename to userId\",\n      \"description\": \"Follows API naming convention (camelCase)\"\n    },\n    {\n      \"id\": \"skip\",\n      \"label\": \"Skip this field\",\n      \"description\": \"Don't include in output - may cause downstream issues\",\n      \"style\": \"danger\"\n    }\n  ],\n  \"allow_custom\": true\n}\n</decision>\n\nAfter outputting the decision block, wait for human input.",
      "decision_points": {
        "enabled": true,
        "trigger": "output",
        "timeout_seconds": 300,
        "routing": {
          "_continue": "next",
          "_retry": "self"
        }
      }
    },
    {
      "name": "apply_decision",
      "instructions": "The human made a decision about how to handle the 'uid' field.\n\nTheir choice was stored in state._decision_process_with_decision:\n{{ state._decision_process_with_decision | tojson }}\n\nApply their decision and report what you did.\n\nIf they chose:\n- user_id: Report that you renamed 'uid' to 'user_id'\n- userId: Report that you renamed 'uid' to 'userId'  \n- skip: Report that you skipped the field\n- custom: Apply whatever custom mapping they specified",
      "context": {
        "from": ["process_with_decision"]
      }
    }
  ]
}
