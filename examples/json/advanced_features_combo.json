{
  "cascade_id": "advanced_features_combo",
  "description": "COMBO: Token Budget + Tool Caching + Output Extraction working together",
  "inputs_schema": {
    "research_topic": "Topic to research with all advanced features"
  },
  "token_budget": {
    "max_total": 15000,
    "reserve_for_output": 3000,
    "strategy": "sliding_window",
    "warning_threshold": 0.8
  },
  "tool_caching": {
    "enabled": true,
    "tools": {
      "sql_search": {
        "enabled": true,
        "ttl": 3600,
        "key": "query",
        "hit_message": "âš¡ Cache hit: Skipped redundant RAG search"
      }
    }
  },
  "phases": [
    {
      "name": "brainstorm",
      "instructions": "Brainstorm research angles for {{ input.research_topic }}.\n\nUse <ideas> tags to capture your thinking:\n<ideas>\n[List multiple research angles and approaches]\n</ideas>\n\nThen summarize your chosen approach.",
      "tackle": [],
      "output_extraction": {
        "pattern": "<ideas>(.*?)</ideas>",
        "store_as": "research_angles",
        "required": true
      },
      "handoffs": ["research"]
    },
    {
      "name": "research",
      "instructions": "Research angles:\n{{ state.research_angles }}\n\nExecute searches for {{ input.research_topic }}. Search multiple times to see caching in action.",
      "tackle": ["sql_search"],
      "context": {"from": ["previous"]},
      "rules": {
        "max_turns": 4
      },
      "handoffs": ["analyze"]
    },
    {
      "name": "analyze",
      "instructions": "Analyze the research findings. Note:\n- Token budget has kept context manageable (no explosion)\n- Tool caching avoided redundant searches (faster execution)\n- You have clean context from phase 1 (scratchpad extracted)\n\nProvide your analysis.",
      "tackle": [],
      "context": {"from": ["previous"]},
      "output_extraction": {
        "pattern": "<analysis>(.*?)</analysis>",
        "store_as": "final_analysis"
      },
      "handoffs": ["summarize"]
    },
    {
      "name": "summarize",
      "instructions": "Wrap in <analysis> tags:\n<analysis>\n[Your final analysis]\n</analysis>",
      "tackle": [],
      "context": {"from": ["all"]}
    }
  ]
}
