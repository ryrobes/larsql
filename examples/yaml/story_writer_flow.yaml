cascade_id: story_writer_flow
description: Interactive story writing with quality gates at each stage
inputs_schema:
  genre: Story genre (sci-fi, fantasy, mystery, etc.)
  protagonist: Main character name
  setting: Where the story takes place
cells:
- handoffs:
  - rising_action
  instructions: 'Write an engaging opening paragraph for a {{ input.genre }} story.


    Protagonist: {{ input.protagonist }}

    Setting: {{ input.setting }}


    The opening should:

    - Hook the reader immediately

    - Establish the setting and mood

    - Introduce the protagonist

    - Be vivid and descriptive'
  name: opening_paragraph
  rules:
    loop_until: grammar_check
    max_attempts: 3
    max_turns: 1
    retry_instructions: 'Editor''s Notes:


      {{ validation_error }}


      Revise the opening to improve grammar and readability. Attempt {{ attempt }}/{{
      max_attempts }}'
- context:
    from:
    - all
  handoffs:
  - climax
  instructions: 'Great opening! Now write the rising action (2-3 paragraphs) that:

    - Builds tension

    - Introduces a conflict or challenge

    - Develops the protagonist''s character

    - MUST mention something ''important'' that the protagonist discovers or realizes'
  name: rising_action
  rules:
    loop_until: keyword_validator
    max_attempts: 3
    max_turns: 1
    retry_instructions: 'Story Development Issue:


      {{ validation_error }}


      The rising action needs to emphasize what''s ''important'' to the protagonist.
      What discovery or realization drives the story forward?


      Attempt {{ attempt }}/{{ max_attempts }}'
- context:
    from:
    - all
  handoffs:
  - resolution
  instructions: 'Excellent build-up! Now write the climax (1-2 paragraphs) where:

    - The main conflict reaches its peak

    - The protagonist must make a crucial decision

    - Tension is at its highest

    - Keep it concise but impactful'
  name: climax
  rules:
    loop_until: simple_validator
    max_attempts: 2
    max_turns: 1
- context:
    from:
    - all
  handoffs:
  - reflect
  instructions: 'Perfect climax! Now write a satisfying resolution (1 paragraph) that:

    - Resolves the main conflict

    - Shows how the protagonist has changed

    - Provides closure

    - Leaves the reader satisfied'
  name: resolution
  rules:
    loop_until: grammar_check
    max_attempts: 2
    max_turns: 1
    retry_instructions: 'Final polish needed:


      {{ validation_error }}


      Clean up the resolution for publication quality.'
- context:
    from:
    - all
  instructions: 'Story complete!


    Provide a brief writer''s commentary:

    - What theme emerged in the story?

    - How many validation retries were needed?

    - What did you learn from the editor''s feedback?'
  name: reflect
  traits:
  - set_state
