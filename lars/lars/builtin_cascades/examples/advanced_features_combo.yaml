cascade_id: advanced_features_combo
description: 'COMBO: Token Budget + Tool Caching + Output Extraction working together'
inputs_schema:
  research_topic: Topic to research with all advanced features
cells:
- handoffs:
  - research
  instructions: 'Brainstorm research angles for {{ input.research_topic }}.


    Use <ideas> tags to capture your thinking:

    <ideas>

    [List multiple research angles and approaches]

    </ideas>


    Then summarize your chosen approach.'
  name: brainstorm
  output_extraction:
    pattern: <ideas>(.*?)</ideas>
    required: true
    store_as: research_angles
  skills: []
- context:
    from:
    - previous
  handoffs:
  - analyze
  instructions: 'Research angles:

    {{ state.research_angles }}


    Execute searches for {{ input.research_topic }}. Search multiple times to see
    caching in action.'
  name: research
  rules:
    max_turns: 4
  skills:
  - sql_search
- context:
    from:
    - previous
  handoffs:
  - summarize
  instructions: 'Analyze the research findings. Note:

    - Token budget has kept context manageable (no explosion)

    - Tool caching avoided redundant searches (faster execution)

    - You have clean context from phase 1 (scratchpad extracted)


    Provide your analysis.'
  name: analyze
  output_extraction:
    pattern: <analysis>(.*?)</analysis>
    store_as: final_analysis
  skills: [manifest]
- context:
    from:
    - all
  instructions: 'Wrap in <analysis> tags:

    <analysis>

    [Your final analysis]

    </analysis>'
  name: summarize
  skills: []
token_budget:
  max_total: 150000
  reserve_for_output: 30000
  strategy: sliding_window
  warning_threshold: 0.8
# tool_caching:
#   enabled: true
#   tools:
#     sql_search:
#       enabled: true
#       hit_message: 'âš¡ Cache hit: Skipped redundant RAG search'
#       key: query
#       ttl: 3600
