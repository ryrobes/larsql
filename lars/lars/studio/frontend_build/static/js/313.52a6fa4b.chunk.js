"use strict";(self.webpackChunklars_ui=self.webpackChunklars_ui||[]).push([[313],{63313:(e,s,t)=>{t.d(s,{A:()=>m});var n=t(89379),a=t(65043),o=t(5748),c=t(77158),l=t(55661),i=t(64745),r=t(3758),d=t(70579);const u=a.memo(e=>{let{inputsSchema:s}=e;const t=Object.keys(s||{});return 0===t.length?null:(0,d.jsxs)("div",{className:"spec-inputs-node",children:[(0,d.jsxs)("div",{className:"spec-inputs-header",children:[(0,d.jsx)(o.In,{icon:"mdi:import",width:"14"}),(0,d.jsx)("span",{children:"Inputs"})]}),(0,d.jsx)("div",{className:"spec-inputs-list",children:t.map(e=>(0,d.jsx)("div",{className:"spec-input-param",title:s[e],children:(0,d.jsx)("span",{className:"spec-input-name",children:e})},e))})]})});u.displayName="InputsNode";const h=a.memo(e=>{var s,t;let{cell:n,isBranch:a,isMerge:c,status:l}=e;const i={sql_data:{label:"SQL",icon:"mdi:database",color:"#60a5fa"},python_data:{label:"Python",icon:"mdi:language-python",color:"#fbbf24"},js_data:{label:"JS",icon:"mdi:language-javascript",color:"#f7df1e"},clojure_data:{label:"Clj",icon:"simple-icons:clojure",color:"#63b132"},llm_cell:{label:"LLM",icon:"mdi:brain",color:"#a78bfa"},lars_data:{label:"LLM",icon:"mdi:sail-boat",color:"#2dd4bf"},linux_shell:{label:"Shell",icon:"mdi:console",color:"#f87171"},linux_shell_dangerous:{label:"Shell",icon:"mdi:console",color:"#f87171"},hitl_screen:{label:"HITL",icon:"mdi:monitor-dashboard",color:"#f97316"}},r=i[n.tool||n.deterministic_tool||(n.hitl?"hitl_screen":n.instructions?"llm_cell":"python_data")]||i.llm_cell,u=(null===(s=n.takes)||void 0===s?void 0:s.factor)>1||n.takes_factor>1||n.has_takes,h=(null===(t=n.takes)||void 0===t?void 0:t.factor)||n.takes_factor,p=n.has_wards||n.ward_count>0,m=n.has_loop_until,g=l?"status-".concat(l):"";return(0,d.jsxs)("div",{className:"spec-cell-node ".concat(u?"has-takes":""," ").concat(g),title:n.name,children:[(0,d.jsxs)("div",{className:"spec-cell-top",children:[(0,d.jsxs)("div",{className:"spec-cell-type",children:[(0,d.jsx)(o.In,{icon:r.icon,width:"14",style:{color:r.color}}),(0,d.jsx)("span",{style:{color:r.color},children:r.label})]}),(0,d.jsxs)("div",{className:"spec-cell-badges",children:[a&&(0,d.jsx)("span",{className:"spec-badge branch",title:"Branches to multiple cells",children:(0,d.jsx)(o.In,{icon:"mdi:source-branch",width:"12"})}),c&&(0,d.jsx)("span",{className:"spec-badge merge",title:"Merges from multiple cells",children:(0,d.jsx)(o.In,{icon:"mdi:source-merge",width:"12"})})]})]}),(0,d.jsx)("div",{className:"spec-cell-name",children:n.name}),(0,d.jsxs)("div",{className:"spec-cell-features",children:[u&&(0,d.jsxs)("span",{className:"spec-feature takes",title:"".concat(h," takes"),children:[(0,d.jsx)(o.In,{icon:"mdi:source-fork",width:"12"}),h,"x"]}),p&&(0,d.jsx)("span",{className:"spec-feature wards",title:"Has validation wards",children:(0,d.jsx)(o.In,{icon:"mdi:shield-check",width:"12"})}),m&&(0,d.jsx)("span",{className:"spec-feature loop",title:"Has loop_until validation",children:(0,d.jsx)(o.In,{icon:"mdi:repeat",width:"12"})}),n.model&&(0,d.jsx)("span",{className:"spec-feature model",title:n.model,children:(0,d.jsx)(o.In,{icon:"mdi:chip",width:"12"})}),n.max_turns>1&&(0,d.jsxs)("span",{className:"spec-feature turns",title:"Max ".concat(n.max_turns," turns"),children:[n.max_turns,"t"]})]}),u&&(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("div",{className:"spec-cell-stack-1"}),(0,d.jsx)("div",{className:"spec-cell-stack-2"})]})]})});h.displayName="CellNode";const p=a.memo(e=>{let{edges:s,width:t,height:n,nodes:o,inputsSchema:c,hasInputs:l,isLinearMode:i,inputNodeY:u}=e;const h=(0,a.useMemo)(()=>{if(!l||!o)return[];const e=[],s=30+24*Object.keys(c||{}).length+16;return o.forEach(t=>{t.inputDeps&&t.inputDeps.length>0&&e.push({sourceX:r.vy+r.RZ,sourceY:u+s/2,targetX:t.x,targetY:t.y+r.dv/2,targetCellIdx:t.cellIdx})}),e},[o,c,l,u]);return(0,d.jsxs)("svg",{className:"spec-graph-edges",style:{position:"absolute",left:0,top:0,width:"".concat(t+100,"px"),height:"".concat(n+100,"px"),pointerEvents:"none",zIndex:0,overflow:"visible",transition:"width 0.3s ease-out, height 0.3s ease-out"},children:[h.map((e,s)=>{const{sourceX:t,sourceY:n,targetX:a,targetY:o,targetCellIdx:c}=e,l=a-t,i=t+.4*l,r=a-.4*l,u="M ".concat(t,",").concat(n," C ").concat(i,",").concat(n," ").concat(r,",").concat(o," ").concat(a,",").concat(o);return(0,d.jsx)("path",{d:u,stroke:"#fbbf24",strokeWidth:"2",strokeDasharray:"6 3",fill:"none",opacity:.6,strokeLinecap:"round",style:{transition:"d 0.3s ease-out"}},"input-edge-".concat(c))}),s.map((e,s)=>{const{source:t,target:n,contextType:a,isBranch:o,isMerge:c}=e,l=(0,r.YR)(t,n),i=(0,r.fV)(a,o||c),u=(0,r.F$)(a);return(0,d.jsx)("path",{d:l,stroke:i,strokeWidth:"2",fill:"none",opacity:u,strokeLinecap:"round",style:{transition:"d 0.3s ease-out"}},"edge-".concat(t.cellIdx,"-").concat(n.cellIdx))})]})});p.displayName="EdgesSVG";const m=e=>{let{cells:s,inputsSchema:t,cascadeId:m,cellStatus:g={}}=e;const f=(0,a.useRef)(null),[x,b]=(0,a.useState)(!1),j=(0,a.useRef)({x:0,y:0,scrollLeft:0,scrollTop:0}),[v,k]=(0,a.useState)(140),[y,w]=(0,a.useState)(!1),N=(0,a.useRef)({y:0,height:0}),[C,L]=(0,a.useState)(!1),[S,I]=(0,a.useState)(""),[_,M]=(0,a.useState)(!1),B=(0,a.useCallback)(async()=>{if(m){L(!0),M(!0);try{const e=await fetch("http://localhost:5050/api/playground/load/".concat(m));if(!e.ok)throw new Error("Failed to load cascade");const s=await e.json(),t=(0,n.A)({},s);delete t._playground;const a=l.Ay.dump(t,{indent:2,lineWidth:120,noRefs:!0,sortKeys:!1});I(a)}catch(e){console.error("Failed to load cascade YAML:",e),I("# Error loading cascade: ".concat(e.message))}finally{M(!1)}}},[m]),E=(0,a.useMemo)(()=>({readOnly:!0,minimap:{enabled:!1},fontSize:12,fontFamily:"'IBM Plex Mono', 'Menlo', monospace",lineNumbers:"on",renderLineHighlight:"line",scrollBeyondLastLine:!1,wordWrap:"on",wrappingStrategy:"advanced",automaticLayout:!0,tabSize:2,folding:!0,foldingStrategy:"indentation",showFoldingControls:"mouseover",bracketPairColorization:{enabled:!0},guides:{indentation:!0,bracketPairs:!0},padding:{top:12,bottom:12},smoothScrolling:!0}),[]),Y=v<180,F=t&&Object.keys(t).length>0,W=(0,a.useMemo)(()=>s&&0!==s.length?(0,r.xb)(s,t,Y,{},F):{nodes:[],edges:[],width:0,height:0},[s,t,Y,F]),D=Y?20:r.C,H=(0,a.useCallback)(e=>{e.preventDefault(),w(!0),N.current={y:e.clientY,height:v}},[v]),T=(0,a.useCallback)(e=>{if(!y)return;const s=e.clientY-N.current.y,t=Math.min(500,Math.max(140,N.current.height+s));k(t)},[y]),z=(0,a.useCallback)(()=>{w(!1)},[]);(0,a.useEffect)(()=>{if(y)return window.addEventListener("mousemove",T),window.addEventListener("mouseup",z),()=>{window.removeEventListener("mousemove",T),window.removeEventListener("mouseup",z)}},[y,T,z]);const G=(0,a.useCallback)(e=>{if(0!==e.button)return;if(e.target.closest(".spec-cell-node, button"))return;const s=f.current;s&&(b(!0),j.current={x:e.clientX,y:e.clientY,scrollLeft:s.scrollLeft,scrollTop:s.scrollTop},e.preventDefault())},[]),A=(0,a.useCallback)(e=>{if(!x)return;const s=f.current;if(!s)return;const t=e.clientX-j.current.x,n=e.clientY-j.current.y;s.scrollLeft=j.current.scrollLeft-t,s.scrollTop=j.current.scrollTop-n},[x]),R=(0,a.useCallback)(()=>{b(!1)},[]);return(0,a.useEffect)(()=>{if(x)return window.addEventListener("mousemove",A),window.addEventListener("mouseup",R),()=>{window.removeEventListener("mousemove",A),window.removeEventListener("mouseup",R)}},[x,A,R]),s&&0!==s.length?(0,d.jsxs)("div",{className:"spec-graph-container ".concat(y?"resizing":""),children:[(0,d.jsxs)("div",{className:"spec-graph-header",children:[(0,d.jsxs)("div",{className:"spec-graph-title",children:[(0,d.jsx)(o.In,{icon:"mdi:sitemap",width:"16"}),(0,d.jsx)("span",{children:"Cascade Structure"}),(0,d.jsxs)("span",{className:"spec-graph-count",children:[s.length," cells"]}),(0,d.jsxs)("span",{className:"spec-graph-mode ".concat(Y?"linear":"graph"),children:[(0,d.jsx)(o.In,{icon:Y?"mdi:arrow-right":"mdi:graph",width:"12"}),Y?"Linear":"Graph"]})]}),(0,d.jsx)("div",{className:"spec-graph-actions",children:(0,d.jsxs)("button",{className:"spec-graph-yaml-btn",onClick:B,title:"View cascade YAML",children:[(0,d.jsx)(o.In,{icon:"mdi:code-braces",width:"14"}),(0,d.jsx)("span",{children:"YAML"})]})}),(0,d.jsxs)("div",{className:"spec-graph-legend",children:[Object.keys(g).length>0&&(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)("div",{className:"legend-item",children:[(0,d.jsx)("div",{className:"legend-dot status-dot",style:{backgroundColor:"#22c55e"}}),(0,d.jsx)("span",{children:"Done"})]}),(0,d.jsxs)("div",{className:"legend-item",children:[(0,d.jsx)("div",{className:"legend-dot status-dot pulsing",style:{backgroundColor:"#fbbf24"}}),(0,d.jsx)("span",{children:"Running"})]}),(0,d.jsxs)("div",{className:"legend-item",children:[(0,d.jsx)("div",{className:"legend-dot status-dot pulsing",style:{backgroundColor:"#f97316"}}),(0,d.jsx)("span",{children:"Waiting"})]}),(0,d.jsx)("div",{className:"legend-separator"})]}),(0,d.jsxs)("div",{className:"legend-item",children:[(0,d.jsx)("div",{className:"legend-dot",style:{backgroundColor:"#fbbf24",border:"1px dashed #fbbf24"}}),(0,d.jsx)("span",{children:"Input"})]}),(0,d.jsxs)("div",{className:"legend-item",children:[(0,d.jsx)("div",{className:"legend-dot",style:{backgroundColor:"#00e5ff"}}),(0,d.jsx)("span",{children:"Data"})]}),(0,d.jsxs)("div",{className:"legend-item",children:[(0,d.jsx)("div",{className:"legend-dot",style:{backgroundColor:"#a78bfa"}}),(0,d.jsx)("span",{children:"Context"})]}),(0,d.jsxs)("div",{className:"legend-item",children:[(0,d.jsx)("div",{className:"legend-dot",style:{backgroundColor:"#64748b"}}),(0,d.jsx)("span",{children:"Flow"})]})]})]}),(0,d.jsx)("div",{ref:f,className:"spec-graph-scroll ".concat(x?"grabbing":""),style:{height:"".concat(v,"px"),cursor:x?"grabbing":"grab"},onMouseDown:G,children:(0,d.jsxs)("div",{className:"spec-graph-canvas",style:{width:"".concat(W.width,"px"),height:"".concat(W.height,"px"),position:"relative",minHeight:"100%",transition:"width 0.3s ease-out, height 0.3s ease-out"},children:[(0,d.jsx)(p,{edges:W.edges,width:W.width,height:W.height,nodes:W.nodes,inputsSchema:t,hasInputs:F,isLinearMode:Y,inputNodeY:D}),F&&(0,d.jsx)("div",{className:"spec-node-wrapper spec-inputs-wrapper",style:{position:"absolute",left:"".concat(r.vy,"px"),top:"".concat(D,"px"),transition:"top 0.3s ease-out, left 0.3s ease-out"},children:(0,d.jsx)(u,{inputsSchema:t})}),W.nodes.map(e=>(0,d.jsx)("div",{className:"spec-node-wrapper",style:{position:"absolute",left:"".concat(e.x,"px"),top:"".concat(e.y,"px"),width:"".concat(r.m8,"px"),transition:"top 0.3s ease-out, left 0.3s ease-out"},children:(0,d.jsx)(h,{cell:e.cell,isBranch:e.isBranch,isMerge:e.isMerge,status:g[e.cell.name]})},"node-".concat(e.cellIdx)))]})}),(0,d.jsx)("div",{className:"spec-graph-resize-handle",onMouseDown:H,title:"Drag to resize (".concat(Y?"expand for graph view":"collapse for linear view",")"),children:(0,d.jsx)("div",{className:"spec-graph-resize-grip"})}),C&&(0,d.jsx)("div",{className:"spec-yaml-modal-overlay",onClick:()=>L(!1),children:(0,d.jsxs)("div",{className:"spec-yaml-modal",onClick:e=>e.stopPropagation(),children:[(0,d.jsxs)("div",{className:"spec-yaml-modal-header",children:[(0,d.jsxs)("div",{className:"spec-yaml-modal-title",children:[(0,d.jsx)(o.In,{icon:"mdi:code-braces",width:"18"}),(0,d.jsx)("span",{children:m})]}),(0,d.jsx)("button",{className:"spec-yaml-modal-close",onClick:()=>L(!1),title:"Close",children:(0,d.jsx)(o.In,{icon:"mdi:close",width:"18"})})]}),(0,d.jsx)("div",{className:"spec-yaml-modal-body",children:_?(0,d.jsxs)("div",{className:"spec-yaml-loading",children:[(0,d.jsx)(o.In,{icon:"mdi:loading",width:"24",className:"spin"}),(0,d.jsx)("span",{children:"Loading cascade..."})]}):(0,d.jsx)(c.Ay,{height:"100%",language:"yaml",theme:i.TH,value:S,options:E,beforeMount:i.$B,onMount:i.JJ})})]})})]}):(0,d.jsxs)("div",{className:"spec-graph-empty",children:[(0,d.jsx)(o.In,{icon:"mdi:file-tree-outline",width:"32"}),(0,d.jsx)("span",{children:"No cells defined"})]})}},64745:(e,s,t)=>{t.d(s,{$B:()=>c,JJ:()=>l,TH:()=>n});const n="studio-dark";let a=!1;const o={base:"vs-dark",inherit:!0,rules:[{token:"key",foreground:"00e5ff"},{token:"key.json",foreground:"00e5ff"},{token:"string",foreground:"a78bfa"},{token:"string.yaml",foreground:"a78bfa"},{token:"string.json",foreground:"a78bfa"},{token:"string.sql",foreground:"a78bfa"},{token:"number",foreground:"34d399"},{token:"number.json",foreground:"34d399"},{token:"keyword",foreground:"f472b6"},{token:"keyword.sql",foreground:"f472b6"},{token:"predefined.sql",foreground:"00e5ff"},{token:"operator.sql",foreground:"cbd5e1"},{token:"keyword.python",foreground:"f472b6"},{token:"identifier.python",foreground:"cbd5e1"},{token:"keyword.js",foreground:"f472b6"},{token:"comment",foreground:"64748b",fontStyle:"italic"},{token:"type",foreground:"00e5ff"},{token:"delimiter.bracket",foreground:"fbbf24"}],colors:{"editor.background":"#050508","editor.foreground":"#cbd5e1","editor.lineHighlightBackground":"#0a0614","editor.selectionBackground":"#1a1628","editorLineNumber.foreground":"#64748b","editorLineNumber.activeForeground":"#cbd5e1","editorCursor.foreground":"#00e5ff","editor.inactiveSelectionBackground":"#0f0a1a","editorIndentGuide.background":"#1a1628","editorIndentGuide.activeBackground":"#2d2640","editorGutter.background":"#050508","minimap.background":"#050508","scrollbarSlider.background":"#1a162880","scrollbarSlider.hoverBackground":"#2d264080","scrollbarSlider.activeBackground":"#3d3650","editorWidget.background":"#0a0614","editorWidget.border":"#1a1628","editorSuggestWidget.background":"#0a0614","editorSuggestWidget.border":"#1a1628","editorSuggestWidget.selectedBackground":"#1a1628","editorHoverWidget.background":"#0a0614","editorHoverWidget.border":"#1a1628"}};function c(e){e.editor.defineTheme(n,o),a||"undefined"===typeof document||(a=!0,document.fonts.ready.then(()=>{document.fonts.check("12px 'Google Sans Code'")?e.editor.remeasureFonts():document.fonts.load("12px 'Google Sans Code'").then(()=>{e.editor.remeasureFonts()}).catch(()=>{console.warn("[Monaco] Google Sans Code font failed to load, using fallback")})}))}function l(e,s){"undefined"!==typeof document&&document.fonts&&document.fonts.ready.then(()=>{s.editor.remeasureFonts()})}}}]);
//# sourceMappingURL=313.52a6fa4b.chunk.js.map