"use strict";(self.webpackChunklars_ui=self.webpackChunklars_ui||[]).push([[313],{63313:(e,s,n)=>{n.d(s,{A:()=>g});var t=n(89379),a=n(65043),o=n(5748),c=n(77158),l=n(55661),i=n(64745),r=n(3758),d=n(24227),u=n(70579);const h=a.memo(e=>{let{inputsSchema:s}=e;const n=Object.keys(s||{});return 0===n.length?null:(0,u.jsxs)("div",{className:"spec-inputs-node",children:[(0,u.jsxs)("div",{className:"spec-inputs-header",children:[(0,u.jsx)(o.In,{icon:"mdi:import",width:"14"}),(0,u.jsx)("span",{children:"Inputs"})]}),(0,u.jsx)("div",{className:"spec-inputs-list",children:n.map(e=>(0,u.jsx)("div",{className:"spec-input-param",title:s[e],children:(0,u.jsx)("span",{className:"spec-input-name",children:e})},e))})]})});h.displayName="InputsNode";const p=a.memo(e=>{var s,n;let{cell:t,isBranch:a,isMerge:c,status:l}=e;const i={sql_data:{label:"SQL",icon:"mdi:database",color:"#60a5fa"},python_data:{label:"Python",icon:"mdi:language-python",color:"#fbbf24"},js_data:{label:"JS",icon:"mdi:language-javascript",color:"#f7df1e"},clojure_data:{label:"Clj",icon:"simple-icons:clojure",color:"#63b132"},llm_cell:{label:"LLM",icon:"mdi:brain",color:"#a78bfa"},lars_data:{label:"LLM",icon:"mdi:sail-boat",color:"#2dd4bf"},linux_shell:{label:"Shell",icon:"mdi:console",color:"#f87171"},linux_shell_dangerous:{label:"Shell",icon:"mdi:console",color:"#f87171"},hitl_screen:{label:"HITL",icon:"mdi:monitor-dashboard",color:"#f97316"}},r=i[t.tool||t.deterministic_tool||(t.hitl?"hitl_screen":t.instructions?"llm_cell":"python_data")]||i.llm_cell,d=(null===(s=t.takes)||void 0===s?void 0:s.factor)>1||t.takes_factor>1||t.has_takes,h=(null===(n=t.takes)||void 0===n?void 0:n.factor)||t.takes_factor,p=t.has_wards||t.ward_count>0,m=t.has_loop_until,g=l?"status-".concat(l):"";return(0,u.jsxs)("div",{className:"spec-cell-node ".concat(d?"has-takes":""," ").concat(g),title:t.name,children:[(0,u.jsxs)("div",{className:"spec-cell-top",children:[(0,u.jsxs)("div",{className:"spec-cell-type",children:[(0,u.jsx)(o.In,{icon:r.icon,width:"14",style:{color:r.color}}),(0,u.jsx)("span",{style:{color:r.color},children:r.label})]}),(0,u.jsxs)("div",{className:"spec-cell-badges",children:[a&&(0,u.jsx)("span",{className:"spec-badge branch",title:"Branches to multiple cells",children:(0,u.jsx)(o.In,{icon:"mdi:source-branch",width:"12"})}),c&&(0,u.jsx)("span",{className:"spec-badge merge",title:"Merges from multiple cells",children:(0,u.jsx)(o.In,{icon:"mdi:source-merge",width:"12"})})]})]}),(0,u.jsx)("div",{className:"spec-cell-name",children:t.name}),(0,u.jsxs)("div",{className:"spec-cell-features",children:[d&&(0,u.jsxs)("span",{className:"spec-feature takes",title:"".concat(h," takes"),children:[(0,u.jsx)(o.In,{icon:"mdi:source-fork",width:"12"}),h,"x"]}),p&&(0,u.jsx)("span",{className:"spec-feature wards",title:"Has validation wards",children:(0,u.jsx)(o.In,{icon:"mdi:shield-check",width:"12"})}),m&&(0,u.jsx)("span",{className:"spec-feature loop",title:"Has loop_until validation",children:(0,u.jsx)(o.In,{icon:"mdi:repeat",width:"12"})}),t.model&&(0,u.jsx)("span",{className:"spec-feature model",title:t.model,children:(0,u.jsx)(o.In,{icon:"mdi:chip",width:"12"})}),t.max_turns>1&&(0,u.jsxs)("span",{className:"spec-feature turns",title:"Max ".concat(t.max_turns," turns"),children:[t.max_turns,"t"]})]}),d&&(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("div",{className:"spec-cell-stack-1"}),(0,u.jsx)("div",{className:"spec-cell-stack-2"})]})]})});p.displayName="CellNode";const m=a.memo(e=>{let{edges:s,width:n,height:t,nodes:o,inputsSchema:c,hasInputs:l,isLinearMode:i,inputNodeY:d}=e;const h=(0,a.useMemo)(()=>{if(!l||!o)return[];const e=[],s=30+24*Object.keys(c||{}).length+16;return o.forEach(n=>{n.inputDeps&&n.inputDeps.length>0&&e.push({sourceX:r.vy+r.RZ,sourceY:d+s/2,targetX:n.x,targetY:n.y+r.dv/2,targetCellIdx:n.cellIdx})}),e},[o,c,l,d]);return(0,u.jsxs)("svg",{className:"spec-graph-edges",style:{position:"absolute",left:0,top:0,width:"".concat(n+100,"px"),height:"".concat(t+100,"px"),pointerEvents:"none",zIndex:0,overflow:"visible",transition:"width 0.3s ease-out, height 0.3s ease-out"},children:[h.map((e,s)=>{const{sourceX:n,sourceY:t,targetX:a,targetY:o,targetCellIdx:c}=e,l=a-n,i=n+.4*l,r=a-.4*l,d="M ".concat(n,",").concat(t," C ").concat(i,",").concat(t," ").concat(r,",").concat(o," ").concat(a,",").concat(o);return(0,u.jsx)("path",{d:d,stroke:"#fbbf24",strokeWidth:"2",strokeDasharray:"6 3",fill:"none",opacity:.6,strokeLinecap:"round",style:{transition:"d 0.3s ease-out"}},"input-edge-".concat(c))}),s.map((e,s)=>{const{source:n,target:t,contextType:a,isBranch:o,isMerge:c}=e,l=(0,r.YR)(n,t),i=(0,r.fV)(a,o||c),d=(0,r.F$)(a);return(0,u.jsx)("path",{d:l,stroke:i,strokeWidth:"2",fill:"none",opacity:d,strokeLinecap:"round",style:{transition:"d 0.3s ease-out"}},"edge-".concat(n.cellIdx,"-").concat(t.cellIdx))})]})});m.displayName="EdgesSVG";const g=e=>{let{cells:s,inputsSchema:n,cascadeId:g,cellStatus:f={}}=e;const x=(0,a.useRef)(null),[b,j]=(0,a.useState)(!1),v=(0,a.useRef)({x:0,y:0,scrollLeft:0,scrollTop:0}),[k,y]=(0,a.useState)(140),[w,N]=(0,a.useState)(!1),C=(0,a.useRef)({y:0,height:0}),[L,S]=(0,a.useState)(!1),[I,_]=(0,a.useState)(""),[M,B]=(0,a.useState)(!1),E=(0,a.useCallback)(async()=>{if(g){S(!0),B(!0);try{const e=await fetch("".concat(d.J,"/api/playground/load/").concat(g));if(!e.ok)throw new Error("Failed to load cascade");const s=await e.json(),n=(0,t.A)({},s);delete n._playground;const a=l.Ay.dump(n,{indent:2,lineWidth:120,noRefs:!0,sortKeys:!1});_(a)}catch(e){console.error("Failed to load cascade YAML:",e),_("# Error loading cascade: ".concat(e.message))}finally{B(!1)}}},[g]),Y=(0,a.useMemo)(()=>({readOnly:!0,minimap:{enabled:!1},fontSize:12,fontFamily:"'IBM Plex Mono', 'Menlo', monospace",lineNumbers:"on",renderLineHighlight:"line",scrollBeyondLastLine:!1,wordWrap:"on",wrappingStrategy:"advanced",automaticLayout:!0,tabSize:2,folding:!0,foldingStrategy:"indentation",showFoldingControls:"mouseover",bracketPairColorization:{enabled:!0},guides:{indentation:!0,bracketPairs:!0},padding:{top:12,bottom:12},smoothScrolling:!0}),[]),F=k<180,W=n&&Object.keys(n).length>0,D=(0,a.useMemo)(()=>s&&0!==s.length?(0,r.xb)(s,n,F,{},W):{nodes:[],edges:[],width:0,height:0},[s,n,F,W]),H=F?20:r.C,T=(0,a.useCallback)(e=>{e.preventDefault(),N(!0),C.current={y:e.clientY,height:k}},[k]),z=(0,a.useCallback)(e=>{if(!w)return;const s=e.clientY-C.current.y,n=Math.min(500,Math.max(140,C.current.height+s));y(n)},[w]),G=(0,a.useCallback)(()=>{N(!1)},[]);(0,a.useEffect)(()=>{if(w)return window.addEventListener("mousemove",z),window.addEventListener("mouseup",G),()=>{window.removeEventListener("mousemove",z),window.removeEventListener("mouseup",G)}},[w,z,G]);const A=(0,a.useCallback)(e=>{if(0!==e.button)return;if(e.target.closest(".spec-cell-node, button"))return;const s=x.current;s&&(j(!0),v.current={x:e.clientX,y:e.clientY,scrollLeft:s.scrollLeft,scrollTop:s.scrollTop},e.preventDefault())},[]),R=(0,a.useCallback)(e=>{if(!b)return;const s=x.current;if(!s)return;const n=e.clientX-v.current.x,t=e.clientY-v.current.y;s.scrollLeft=v.current.scrollLeft-n,s.scrollTop=v.current.scrollTop-t},[b]),J=(0,a.useCallback)(()=>{j(!1)},[]);return(0,a.useEffect)(()=>{if(b)return window.addEventListener("mousemove",R),window.addEventListener("mouseup",J),()=>{window.removeEventListener("mousemove",R),window.removeEventListener("mouseup",J)}},[b,R,J]),s&&0!==s.length?(0,u.jsxs)("div",{className:"spec-graph-container ".concat(w?"resizing":""),children:[(0,u.jsxs)("div",{className:"spec-graph-header",children:[(0,u.jsxs)("div",{className:"spec-graph-title",children:[(0,u.jsx)(o.In,{icon:"mdi:sitemap",width:"16"}),(0,u.jsx)("span",{children:"Cascade Structure"}),(0,u.jsxs)("span",{className:"spec-graph-count",children:[s.length," cells"]}),(0,u.jsxs)("span",{className:"spec-graph-mode ".concat(F?"linear":"graph"),children:[(0,u.jsx)(o.In,{icon:F?"mdi:arrow-right":"mdi:graph",width:"12"}),F?"Linear":"Graph"]})]}),(0,u.jsx)("div",{className:"spec-graph-actions",children:(0,u.jsxs)("button",{className:"spec-graph-yaml-btn",onClick:E,title:"View cascade YAML",children:[(0,u.jsx)(o.In,{icon:"mdi:code-braces",width:"14"}),(0,u.jsx)("span",{children:"YAML"})]})}),(0,u.jsxs)("div",{className:"spec-graph-legend",children:[Object.keys(f).length>0&&(0,u.jsxs)(u.Fragment,{children:[(0,u.jsxs)("div",{className:"legend-item",children:[(0,u.jsx)("div",{className:"legend-dot status-dot",style:{backgroundColor:"#22c55e"}}),(0,u.jsx)("span",{children:"Done"})]}),(0,u.jsxs)("div",{className:"legend-item",children:[(0,u.jsx)("div",{className:"legend-dot status-dot pulsing",style:{backgroundColor:"#fbbf24"}}),(0,u.jsx)("span",{children:"Running"})]}),(0,u.jsxs)("div",{className:"legend-item",children:[(0,u.jsx)("div",{className:"legend-dot status-dot pulsing",style:{backgroundColor:"#f97316"}}),(0,u.jsx)("span",{children:"Waiting"})]}),(0,u.jsx)("div",{className:"legend-separator"})]}),(0,u.jsxs)("div",{className:"legend-item",children:[(0,u.jsx)("div",{className:"legend-dot",style:{backgroundColor:"#fbbf24",border:"1px dashed #fbbf24"}}),(0,u.jsx)("span",{children:"Input"})]}),(0,u.jsxs)("div",{className:"legend-item",children:[(0,u.jsx)("div",{className:"legend-dot",style:{backgroundColor:"#00e5ff"}}),(0,u.jsx)("span",{children:"Data"})]}),(0,u.jsxs)("div",{className:"legend-item",children:[(0,u.jsx)("div",{className:"legend-dot",style:{backgroundColor:"#a78bfa"}}),(0,u.jsx)("span",{children:"Context"})]}),(0,u.jsxs)("div",{className:"legend-item",children:[(0,u.jsx)("div",{className:"legend-dot",style:{backgroundColor:"#64748b"}}),(0,u.jsx)("span",{children:"Flow"})]})]})]}),(0,u.jsx)("div",{ref:x,className:"spec-graph-scroll ".concat(b?"grabbing":""),style:{height:"".concat(k,"px"),cursor:b?"grabbing":"grab"},onMouseDown:A,children:(0,u.jsxs)("div",{className:"spec-graph-canvas",style:{width:"".concat(D.width,"px"),height:"".concat(D.height,"px"),position:"relative",minHeight:"100%",transition:"width 0.3s ease-out, height 0.3s ease-out"},children:[(0,u.jsx)(m,{edges:D.edges,width:D.width,height:D.height,nodes:D.nodes,inputsSchema:n,hasInputs:W,isLinearMode:F,inputNodeY:H}),W&&(0,u.jsx)("div",{className:"spec-node-wrapper spec-inputs-wrapper",style:{position:"absolute",left:"".concat(r.vy,"px"),top:"".concat(H,"px"),transition:"top 0.3s ease-out, left 0.3s ease-out"},children:(0,u.jsx)(h,{inputsSchema:n})}),D.nodes.map(e=>(0,u.jsx)("div",{className:"spec-node-wrapper",style:{position:"absolute",left:"".concat(e.x,"px"),top:"".concat(e.y,"px"),width:"".concat(r.m8,"px"),transition:"top 0.3s ease-out, left 0.3s ease-out"},children:(0,u.jsx)(p,{cell:e.cell,isBranch:e.isBranch,isMerge:e.isMerge,status:f[e.cell.name]})},"node-".concat(e.cellIdx)))]})}),(0,u.jsx)("div",{className:"spec-graph-resize-handle",onMouseDown:T,title:"Drag to resize (".concat(F?"expand for graph view":"collapse for linear view",")"),children:(0,u.jsx)("div",{className:"spec-graph-resize-grip"})}),L&&(0,u.jsx)("div",{className:"spec-yaml-modal-overlay",onClick:()=>S(!1),children:(0,u.jsxs)("div",{className:"spec-yaml-modal",onClick:e=>e.stopPropagation(),children:[(0,u.jsxs)("div",{className:"spec-yaml-modal-header",children:[(0,u.jsxs)("div",{className:"spec-yaml-modal-title",children:[(0,u.jsx)(o.In,{icon:"mdi:code-braces",width:"18"}),(0,u.jsx)("span",{children:g})]}),(0,u.jsx)("button",{className:"spec-yaml-modal-close",onClick:()=>S(!1),title:"Close",children:(0,u.jsx)(o.In,{icon:"mdi:close",width:"18"})})]}),(0,u.jsx)("div",{className:"spec-yaml-modal-body",children:M?(0,u.jsxs)("div",{className:"spec-yaml-loading",children:[(0,u.jsx)(o.In,{icon:"mdi:loading",width:"24",className:"spin"}),(0,u.jsx)("span",{children:"Loading cascade..."})]}):(0,u.jsx)(c.Ay,{height:"100%",language:"yaml",theme:i.TH,value:I,options:Y,beforeMount:i.$B,onMount:i.JJ})})]})})]}):(0,u.jsxs)("div",{className:"spec-graph-empty",children:[(0,u.jsx)(o.In,{icon:"mdi:file-tree-outline",width:"32"}),(0,u.jsx)("span",{children:"No cells defined"})]})}},64745:(e,s,n)=>{n.d(s,{$B:()=>c,JJ:()=>l,TH:()=>t});const t="studio-dark";let a=!1;const o={base:"vs-dark",inherit:!0,rules:[{token:"key",foreground:"00e5ff"},{token:"key.json",foreground:"00e5ff"},{token:"string",foreground:"a78bfa"},{token:"string.yaml",foreground:"a78bfa"},{token:"string.json",foreground:"a78bfa"},{token:"string.sql",foreground:"a78bfa"},{token:"number",foreground:"34d399"},{token:"number.json",foreground:"34d399"},{token:"keyword",foreground:"f472b6"},{token:"keyword.sql",foreground:"f472b6"},{token:"predefined.sql",foreground:"00e5ff"},{token:"operator.sql",foreground:"cbd5e1"},{token:"keyword.python",foreground:"f472b6"},{token:"identifier.python",foreground:"cbd5e1"},{token:"keyword.js",foreground:"f472b6"},{token:"comment",foreground:"64748b",fontStyle:"italic"},{token:"type",foreground:"00e5ff"},{token:"delimiter.bracket",foreground:"fbbf24"}],colors:{"editor.background":"#050508","editor.foreground":"#cbd5e1","editor.lineHighlightBackground":"#0a0614","editor.selectionBackground":"#1a1628","editorLineNumber.foreground":"#64748b","editorLineNumber.activeForeground":"#cbd5e1","editorCursor.foreground":"#00e5ff","editor.inactiveSelectionBackground":"#0f0a1a","editorIndentGuide.background":"#1a1628","editorIndentGuide.activeBackground":"#2d2640","editorGutter.background":"#050508","minimap.background":"#050508","scrollbarSlider.background":"#1a162880","scrollbarSlider.hoverBackground":"#2d264080","scrollbarSlider.activeBackground":"#3d3650","editorWidget.background":"#0a0614","editorWidget.border":"#1a1628","editorSuggestWidget.background":"#0a0614","editorSuggestWidget.border":"#1a1628","editorSuggestWidget.selectedBackground":"#1a1628","editorHoverWidget.background":"#0a0614","editorHoverWidget.border":"#1a1628"}};function c(e){e.editor.defineTheme(t,o),a||"undefined"===typeof document||(a=!0,document.fonts.ready.then(()=>{document.fonts.check("12px 'Google Sans Code'")?e.editor.remeasureFonts():document.fonts.load("12px 'Google Sans Code'").then(()=>{e.editor.remeasureFonts()}).catch(()=>{console.warn("[Monaco] Google Sans Code font failed to load, using fallback")})}))}function l(e,s){"undefined"!==typeof document&&document.fonts&&document.fonts.ready.then(()=>{s.editor.remeasureFonts()})}}}]);
//# sourceMappingURL=313.9e2239b8.chunk.js.map