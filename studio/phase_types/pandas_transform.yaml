type_id: pandas_transform
display_name: Pandas Transform
icon: mdi:table-edit
color: "#fbbf24"
name_prefix: transform
description: "Advanced Python data transformation with pandas - ETL and data wrangling"
category: "data"
tags:
  - "intermediate"
  - "data-processing"
  - "etl"
  - "chain"

template:
  tool: python_data
  inputs:
    code: |
      import pandas as pd
      import numpy as np

      # Get data from prior cell
      df = data.previous_phase

      # Example transformations:
      # - Filter: df = df[df['column'] > 100]
      # - Group: df = df.groupby('category').agg({'value': 'sum'})
      # - Join: df = df.merge(other_df, on='id')
      # - Pivot: df = df.pivot(index='date', columns='category', values='value')
      # - Clean: df['column'] = df['column'].str.strip().str.lower()

      # Your transformation here:
      result = df  # Return transformed DataFrame
